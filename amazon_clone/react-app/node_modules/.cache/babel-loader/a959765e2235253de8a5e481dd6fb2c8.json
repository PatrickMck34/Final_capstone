{"ast":null,"code":"import { csrfFetch } from './csrf';\nconst READ_REVIEWS = '/reviews';\nconst DELETE_REVIEW = '/reviews/:reviewId';\nconst CREATE_REVIEW = '/reviews/new';\nconst READ_REVIEW = '/reviews/spotsid';\nexport const createReviews = reviews => async dispatch => {\n  const {\n    review,\n    stars,\n    spotId\n  } = reviews;\n  const data = await csrfFetch(`/api/spots/${spotId}/reviews`, {\n    method: \"POST\",\n    body: JSON.stringify({\n      review,\n      stars\n    })\n  });\n  const response = await data.json();\n  dispatch(createReview(response));\n  return response;\n};\nexport const createReview = review => ({\n  type: CREATE_REVIEW,\n  payload: review\n});\nexport const getReviews = spotId => async dispatch => {\n  const data = await csrfFetch(`/api/spots/${spotId}/reviews`);\n  const response = await data.json();\n  dispatch(getReview(response));\n  return response;\n};\nexport const getReview = review => ({\n  type: READ_REVIEWS,\n  payload: review\n});\nexport const deleteReviews = id => async dispatch => {\n  const response = await Fetch(`/api/reviews/${id}`, {\n    method: 'DELETE'\n  });\n  dispatch(deleteReview(id));\n  return response;\n};\nexport const deleteReview = reviewId => {\n  return {\n    type: DELETE_REVIEW,\n    reviewId\n  };\n};\nconst initialState = {\n  allReviews: {},\n  singleSpotReviews: {}\n};\nexport const reviewsReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState = {};\n  switch (action.type) {\n    case CREATE_REVIEW:\n      newState = {\n        allReviews: {\n          ...state.allReviews\n        }\n      };\n      newState.allReviews[action.payload.id] = action.payload;\n      return newState;\n    case READ_REVIEWS:\n      newState = {\n        allReviews: {}\n      };\n      action.payload.Reviews.forEach(reviews => newState.allReviews[reviews.id] = reviews);\n      return newState;\n    case READ_REVIEW:\n      newState = {\n        singleSpotReviews: {}\n      };\n      action.payload.Reviews.forEach(reviews => newState.singleSpotReviews[reviews.id] = reviews);\n      return newState;\n    case DELETE_REVIEW:\n      newState = {\n        ...state\n      };\n      delete newState[action.payload];\n    default:\n      return state;\n  }\n};\nexport default reviewsReducer;","map":{"version":3,"names":["csrfFetch","READ_REVIEWS","DELETE_REVIEW","CREATE_REVIEW","READ_REVIEW","createReviews","reviews","dispatch","review","stars","spotId","data","method","body","JSON","stringify","response","json","createReview","type","payload","getReviews","getReview","deleteReviews","id","Fetch","deleteReview","reviewId","initialState","allReviews","singleSpotReviews","reviewsReducer","state","action","newState","Reviews","forEach"],"sources":["/home/patrick/cap_final/amazon_clone/react-app/src/store/review.js"],"sourcesContent":["import { csrfFetch } from './csrf'; \n\nconst READ_REVIEWS = '/reviews'\nconst DELETE_REVIEW = '/reviews/:reviewId';\nconst CREATE_REVIEW = '/reviews/new'\nconst READ_REVIEW = '/reviews/spotsid'\n\nexport const createReviews = (reviews) => async (dispatch) => {\n    const {review, stars, spotId} = reviews\n const data = await csrfFetch(`/api/spots/${spotId}/reviews` , {\n        method: \"POST\",\n        body: JSON.stringify({\n           review, stars\n        }),\n    });\n    const response = await data.json()\n    \n    dispatch(createReview(response))\n    return response\n}\n\nexport const createReview = (review) =>({\n    type: CREATE_REVIEW,\n    payload: review\n})\nexport const getReviews = (spotId) => async (dispatch) => {\nconst data = await csrfFetch(`/api/spots/${spotId}/reviews`)\n    const response = await data.json()\n    dispatch(getReview(response))\n    return response\n}\nexport const getReview = (review) =>({\n    type: READ_REVIEWS,\n    payload: review\n})\nexport const deleteReviews = (id) => async (dispatch) => {\n    const response = await Fetch(`/api/reviews/${id}`, {\n        method: 'DELETE',\n    });\n    dispatch(deleteReview(id));\n    return response;\n};\nexport  const deleteReview = (reviewId) => {\n    return {\n        type: DELETE_REVIEW,\n        reviewId\n    };\n};\n\nconst initialState =  {allReviews:{}, singleSpotReviews: {}}\nexport const reviewsReducer = (state = initialState, action) => {\n    let newState = {}\n    \n    switch (action.type) {\n               case CREATE_REVIEW:\n                 newState = { allReviews:{...state.allReviews}} \n                newState.allReviews[action.payload.id] = action.payload\n                return newState\n\n                case READ_REVIEWS:\n                 newState ={allReviews: {} };\n                 action.payload.Reviews.forEach(reviews => newState.allReviews[reviews.id] = reviews)\n                return newState\n\n                case READ_REVIEW:\n                 newState ={singleSpotReviews: {} };\n                 action.payload.Reviews.forEach(reviews => newState.singleSpotReviews[reviews.id] = reviews)\n                return newState \n\n                case DELETE_REVIEW:\n             newState = {...state}\n             delete newState[action.payload]\n            \n      default:\n    return state\n}}\nexport default reviewsReducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}